{"ast":null,"code":"var _jsxFileName = \"G:\\\\Projects\\\\Programming\\\\wgucapstonedev\\\\client\\\\src\\\\routes\\\\login.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\n\nclass login extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      username: '',\n      password: '',\n      updated_date: '',\n      created_date: '',\n      count: '',\n      error: '',\n      path: window.location.protocol + '//' + window.location.hostname\n    };\n    this.onChange = this.onChange.bind(this);\n    this.onSubmit = this.onSubmit.bind(this);\n  }\n\n  componentDidMount() {\n    this.checkLoginSession();\n    this.checkUserCount();\n  }\n\n  onChange(event) {\n    const state = this.state;\n    state[event.target.name] = event.target.value;\n    this.setState(state);\n  }\n\n  onSubmit(e) {\n    e.preventDefault();\n    axios.get(this.state.path + ':5000/user/u/' + this.state.username).then(res => {\n      this.setState({\n        user: res.data\n      });\n      console.log(this.state.user); //pulls the user if it exists\n    }).finally(() => {\n      try {\n        if (this.state.username === '') throw \"ERROR: Username was left blank.\";\n        if (this.state.password === '') throw \"ERROR: Password was left blank.\";\n        if (this.state.user === null) throw \"ERROR: Username or password is incorrect.\";\n        if (this.state.user.password !== this.state.password) throw \"ERROR: Username or password is incorrect.\";\n      } catch (err) {\n        this.setState({\n          error: err\n        });\n\n        if (document.getElementById(\"error\") !== null) {\n          document.getElementById(\"error\").classList.remove('d-none');\n        }\n\n        return;\n      }\n\n      this.createLoginSession();\n      this.props.history.push(\"/main\");\n    });\n  }\n\n  checkUserCount() {\n    let count = 0;\n    axios.get(this.state.path + ':5000/user/count').then(res => {\n      this.setState({\n        count: res.data\n      });\n      count = res.data;\n      console.log(\"user count: \" + count); //pulls the user if it exists\n    }).finally(() => {\n      if (count <= 0) {\n        //logic here for creating user;\n        this.setState({\n          updated_date: Date.now\n        });\n        this.setState({\n          created_date: Date.now\n        });\n        const username = \"Admin\";\n        const type = \"Admin\";\n        const password = \"admin\";\n        const updatedBy = \"Admin\";\n        const createdBy = \"Admin\";\n        const updatedDate = new Date();\n        const createdDate = new Date();\n        axios.post(this.state.path + ':5000/user', {\n          username,\n          type,\n          password,\n          updatedBy,\n          createdBy,\n          updatedDate,\n          createdDate\n        }).then(result => {});\n      }\n    });\n  }\n\n  checkLoginSession() {\n    if (localStorage.getItem(\"isLoggedIn\") === 'false' || !localStorage.getItem(\"isLoggedIn\")) {\n      this.props.history.push(\"/\");\n    } else if (localStorage.getItem(\"isLoggedIn\") === 'true') {\n      this.props.history.push(\"/main\");\n    }\n  }\n\n  createLoginSession() {\n    console.log(this.state.user._id);\n    localStorage.setItem(\"userId\", this.state.user._id);\n    localStorage.setItem(\"username\", this.state.user.username);\n    localStorage.setItem(\"userType\", this.state.user.type);\n    localStorage.setItem(\"isLoggedIn\", true);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"form\", {\n      className: \"form-login border text-center full-center\",\n      onSubmit: this.onSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: \"error\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 5\n      }\n    }, this.state.error), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Username\",\n      name: \"username\",\n      value: this.state.username,\n      onChange: this.onChange,\n      className: \"form-control\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 6\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"password\",\n      placeholder: \"Password\",\n      name: \"password\",\n      value: this.state.password,\n      onChange: this.onChange,\n      className: \"form-control\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 6\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-lg btn-primary btn-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 7\n      }\n    }, \"Sign in\"))));\n  }\n\n}\n\nexport default login;","map":{"version":3,"sources":["G:/Projects/Programming/wgucapstonedev/client/src/routes/login.js"],"names":["React","Component","axios","login","constructor","props","state","username","password","updated_date","created_date","count","error","path","window","location","protocol","hostname","onChange","bind","onSubmit","componentDidMount","checkLoginSession","checkUserCount","event","target","name","value","setState","e","preventDefault","get","then","res","user","data","console","log","finally","err","document","getElementById","classList","remove","createLoginSession","history","push","Date","now","type","updatedBy","createdBy","updatedDate","createdDate","post","result","localStorage","getItem","_id","setItem","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport axios from 'axios';\r\n\r\n\r\nclass login extends Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tusername: '',\r\n\t\t\tpassword: '',\r\n\t\t\tupdated_date: '',\r\n\t\t\tcreated_date: '',\r\n\t\t\tcount: '',\r\n\t\t\terror: '',\r\n\t\t\tpath: window.location.protocol + '//' + window.location.hostname\r\n\t\t};\r\n\r\n\t\tthis.onChange = this.onChange.bind(this);\r\n\t\tthis.onSubmit = this.onSubmit.bind(this);\r\n\r\n\t}\r\n\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.checkLoginSession();\r\n\t\tthis.checkUserCount();\r\n\t}\r\n\r\n\r\n\tonChange(event) {\r\n\t\tconst state = this.state\r\n\t\tstate[event.target.name] = event.target.value;\r\n\t\tthis.setState(state);\r\n\t}\r\n\r\n\tonSubmit(e) {\r\n\t\te.preventDefault();\r\n\r\n\t\taxios.get(this.state.path + ':5000/user/u/' + this.state.username)\r\n\t\t\t.then(res => {\r\n\t\t\t\tthis.setState({ user: res.data });\r\n\t\t\t\tconsole.log(this.state.user); //pulls the user if it exists\r\n\t\t\t}).finally(() => {\r\n\r\n\r\n\t\t\t\ttry{\r\n\t\t\t\t\tif (this.state.username === '' ) throw \"ERROR: Username was left blank.\"\r\n\t\t\t\t\tif (this.state.password === '' ) throw \"ERROR: Password was left blank.\"\r\n\t\t\t\t\tif (this.state.user === null ) throw \"ERROR: Username or password is incorrect.\"\r\n\t\t\t\t\tif (this.state.user.password !== this.state.password ) throw \"ERROR: Username or password is incorrect.\"\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tcatch(err){\r\n\t\t\t\t\tthis.setState({ error: err })\r\n\t\t\t\t\tif (document.getElementById(\"error\") !== null) {\r\n\t\t\t\t\t\tdocument.getElementById(\"error\").classList.remove('d-none');\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\r\n\t\t\t\tthis.createLoginSession();\r\n\r\n\t\t\t\tthis.props.history.push(\"/main\")\r\n\r\n\t\t\t});\r\n\t\t\t\r\n\r\n\t}\r\n\r\n\r\n\tcheckUserCount() {\r\n\t\tlet count = 0;\r\n\t\taxios.get(this.state.path + ':5000/user/count')\r\n\t\t\t.then(res => {\r\n\t\t\t\tthis.setState({ count: res.data });\r\n\t\t\t\tcount = res.data\r\n\t\t\t\tconsole.log(\"user count: \" + count); //pulls the user if it exists\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tif (count <= 0) {\r\n\t\t\t\t\t//logic here for creating user;\r\n\r\n\t\t\t\t\tthis.setState({ updated_date: Date.now })\r\n\t\t\t\t\tthis.setState({ created_date: Date.now })\r\n\r\n\r\n\t\t\t\t\tconst username = \"Admin\";\r\n\t\t\t\t\tconst type = \"Admin\"\r\n\t\t\t\t\tconst password = \"admin\";\r\n\t\t\t\t\tconst updatedBy = \"Admin\";\r\n\t\t\t\t\tconst createdBy = \"Admin\";\r\n\t\t\t\t\tconst updatedDate = new Date();\r\n\t\t\t\t\tconst createdDate = new Date();\r\n\r\n\r\n\t\t\t\t\taxios.post(this.state.path + ':5000/user', { username, type, password, updatedBy, createdBy, updatedDate, createdDate })\r\n\t\t\t\t\t\t.then((result) => {\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\r\n\tcheckLoginSession() {\r\n\t\tif (localStorage.getItem(\"isLoggedIn\") === 'false'  || !localStorage.getItem(\"isLoggedIn\")) {\r\n\t\t\tthis.props.history.push(\"/\")\r\n\t\t} else if(localStorage.getItem(\"isLoggedIn\") === 'true'){\r\n\t\t\tthis.props.history.push(\"/main\")\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tcreateLoginSession() {\r\n\t\tconsole.log(this.state.user._id);\r\n\t\tlocalStorage.setItem(\"userId\", this.state.user._id);\r\n\t\tlocalStorage.setItem(\"username\", this.state.user.username);\r\n\t\tlocalStorage.setItem(\"userType\", this.state.user.type);\r\n\t\tlocalStorage.setItem(\"isLoggedIn\", true);\r\n\t}\r\n\r\n\r\n\trender() {\r\n\t\treturn (\r\n\r\n\t\t\t<form className=\"form-login border text-center full-center\" onSubmit={this.onSubmit}>\r\n\t\t\t\t<p className=\"error\">{this.state.error}</p>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<input type=\"text\" placeholder=\"Username\" name=\"username\" value={this.state.username} onChange={this.onChange} className=\"form-control\" />\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<input type=\"password\" placeholder=\"Password\" name=\"password\" value={this.state.password} onChange={this.onChange} className=\"form-control\" />\r\n\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t<div className=\"col\">\r\n\t\t\t\t\t\t<button className=\"btn btn-lg btn-primary btn-block\">Sign in</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</form>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default login;\r\n"]},"metadata":{},"sourceType":"module"}